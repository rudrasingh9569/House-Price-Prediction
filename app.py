from sklearn.ensemble import RandomForestRegressor
import streamlit as st
import pickle
from sklearn.preprocessing import StandardScaler
import pandas as pd
import time
from sklearn.datasets import fetch_california_housing
st.title('üè†House Price prediction using ML')

st.image('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRvQdqIasHkDTf5733FK14z5mPQ18VPhg_R_Q&s')

df = pd.read_csv('house_data.csv')
X = df.iloc[:,:-3]
y = df.iloc[:,-1]

final_X = X
scaler = StandardScaler()
scaled_X = scaler.fit_transform(final_X)

st.sidebar.title('Select House features: ')
st.sidebar.image('data:image/jpeg;base64,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')

all_value = []
for i in final_X:
  min_value = x[i].min()
  max_value = X[i].max()
  result = st.sidebar.slider(f'Select{i}value',min_value,max_value)
  all_value.append(result)

user_X = scaler.transform([all_value])

@st.cache_data
def ml_model(X,y):
  model = RandomForestRegressor()
  model.fit(X,y)
  return model

model = ml_model(scaled_X,y)
house_price = model.predict(user_X)[0]

final_price = round(house_price * 100000,2)

with st.spinner('Predicting House Price'):
  import time
  time.sleep(2)

st.success(f'Estimated House Price is : $ {final_price}')
st.markdown('''**Design and Devloped by : Rudra Pratap Singh**''')

